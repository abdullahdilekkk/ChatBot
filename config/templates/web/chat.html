{% extends "base.html" %}

{% block content %}
<div class="row g-4">
  <!-- SOL SÃœTUN: Sidebar -->
  <div class="col-12 col-md-3">
    <nav class="list-group">
      {% for cs in sessions %}
        <a href="{% url 'chat' cs.pk %}"
           class="list-group-item list-group-item-action {% if session.pk == cs.pk %}active{% endif %} text-truncate">
          {{ cs.title|default:"Sohbet #" }}
        </a>
      {% empty %}
        <div class="text-muted">Sohbet yok.</div>
      {% endfor %}
    </nav>
  </div>

  <!-- SAÄž SÃœTUN: Chat alanÄ± -->
  <div class="col-12 col-md-9">
    <h4 class="mb-1">Chat</h4>
    <p class="text-muted mb-3">Start a conversation with your AI assistant.</p>

    <div class="border rounded-4 p-3 mb-3" style="height: 55vh; overflow:auto;">
      {% if chat_history %}
        {% for m in chat_history %}
          <div class="mb-3">
            <div class="small text-muted mb-1">
              {% if m.sender == 'ai' %}Asistan{% else %}Sen{% endif %} Â· {{ m.created|date:"H:i" }}
            </div>
            <div class="p-2 rounded {% if m.sender == 'ai' %}bg-white border{% else %}bg-success-subtle{% endif %}">
              {{ m.text|linebreaksbr }}
            </div>
          </div>
        {% endfor %}
      {% else %}
        <div class="text-muted">No messages yet. Say hi ðŸ‘‹</div>
      {% endif %}
    </div>

    <form method="post" class="d-flex gap-2">
      {% csrf_token %}
      <textarea name="user_input" rows="2" class="form-control" placeholder="Type a message..."></textarea>
      <button class="btn btn-success px-4">Send</button>
    </form>
  </div>
</div>
{% endblock %}
