{% extends "base.html" %}
{% block title %}Sohbet{% endblock %}

{% block content %}
<h2 class="mb-3">Sohbet</h2>

<style>
  .chat-box { height: 60vh; overflow-y: auto; background:#f7f7f7; border:1px solid #928b8bff; border-radius:10px; padding:12px; }
  .msg     { max-width: 75%; padding:8px 12px; border-radius:12px; margin:6px 0; word-wrap: break-word; }
  .msg.ai  { background:#ffffff; border:1px solid #b7b1b1ff; text-align:left; }
  .msg.me  { background:#7a7d7b;  border:1px solid #626665ff; text-align:right; margin-left:auto; }
  .meta    { font-size:12px; color:#6b7280; margin-bottom:4px; }
</style>

<div id="chatBox" class="chat-box mb-3">
  {% if chat_history %}
    {% for m in chat_history %}
      <div class="msg {% if m.sender == 'ai' %}ai{% else %}me{% endif %}">
        <div class="meta">
          {% if m.sender == 'ai' %}Asistan{% else %}Sen{% endif %} Â· {{ m.created|date:"H:i" }}
        </div>
        {{ m.text }}
      </div>
    {% endfor %}
  {% else %}
    <div class="text-muted">HenÃ¼z mesaj yok. Ä°lk mesajÄ±nÄ± yaz ðŸ‘‡</div>
  {% endif %}
</div>

<form method="post" class="d-grid gap-2">
  {% csrf_token %}
  <textarea name="user_input" id="messageInput" rows="2" class="form-control" placeholder="MesajÄ±nÄ± yaz..." required></textarea>
  <button type="submit" class="btn" style="background-color:#7a7d7b; border-color:#7a7d7b; color:#fff;">GÃ¶nder</button>
</form>


  
<script>
    window.onload = function() {
        var box = document.getElementById("chatBox");
        box.scrollTop = box.scrollHeight;
    };
</script>

{% endblock %}
